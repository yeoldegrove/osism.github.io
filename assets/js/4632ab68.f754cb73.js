"use strict";(self.webpackChunkosism=self.webpackChunkosism||[]).push([[8521],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>g});var o=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var i=o.createContext({}),p=function(e){var n=o.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},c=function(e){var n=p(e.components);return o.createElement(i.Provider,{value:n},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},u=o.forwardRef((function(e,n){var t=e.components,r=e.mdxType,a=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=p(t),u=r,g=m["".concat(i,".").concat(u)]||m[u]||d[u]||a;return t?o.createElement(g,l(l({ref:n},c),{},{components:t})):o.createElement(g,l({ref:n},c))}));function g(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var a=t.length,l=new Array(a);l[0]=u;var s={};for(var i in n)hasOwnProperty.call(n,i)&&(s[i]=n[i]);s.originalType=e,s[m]="string"==typeof e?e:r,l[1]=s;for(var p=2;p<a;p++)l[p]=t[p];return o.createElement.apply(null,l)}return o.createElement.apply(null,t)}u.displayName="MDXCreateElement"},5624:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var o=t(7462),r=(t(7294),t(3905));const a={sidebar_label:"Logging",sidebar_position:10},l="Logging",s={unversionedId:"guides/operations-guide/manager/log",id:"guides/operations-guide/manager/log",title:"Logging",description:"Ansible",source:"@site/docs/guides/operations-guide/manager/log.md",sourceDirName:"guides/operations-guide/manager",slug:"/guides/operations-guide/manager/log",permalink:"/docs/guides/operations-guide/manager/log",draft:!1,editUrl:"https://github.com/osism/osism.github.io/tree/main/docs/guides/operations-guide/manager/log.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_label:"Logging",sidebar_position:10},sidebar:"tutorialSidebar",previous:{title:"Apply",permalink:"/docs/guides/operations-guide/manager/apply"},next:{title:"Console",permalink:"/docs/guides/operations-guide/manager/console"}},i={},p=[{value:"Ansible",id:"ansible",level:2},{value:"Sample usage",id:"sample-usage",level:3},{value:"Container",id:"container",level:2},{value:"OpenSearch",id:"opensearch",level:2}],c={toc:p},m="wrapper";function d(e){let{components:n,...t}=e;return(0,r.kt)(m,(0,o.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"logging"},"Logging"),(0,r.kt)("h2",{id:"ansible"},"Ansible"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"$ osism log ansible\n(ara) help\n\nDocumented commands (use 'help -v' for verbose/'help <topic>' for details):\n===========================================================================\nalias  exit  history  quit          run_script  shell\nedit   help  macro    run_pyscript  set         shortcuts\n\nApplication commands (type help <topic>):\n=========================================\ncomplete     host metrics  playbook delete   record delete  result show\nexpire       host show     playbook list     record list    task delete\nhelp         play delete   playbook metrics  record show    task list\nhost delete  play list     playbook prune    result delete  task metrics\nhost list    play show     playbook show     result list    task show\n")),(0,r.kt)("h3",{id:"sample-usage"},"Sample usage"),(0,r.kt)("p",null,"As an example, the role common is run. Irrelevant parts of outputs have been removed."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"$ osism apply common\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"$ osism log ansible\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"(ara) play list\n+----+-----------+-------------------------------------------------------+----------+-------+---------+-----------------------------+-----------------+\n| id | status    | name                                                  | playbook | tasks | results | started                     | duration        |\n+----+-----------+-------------------------------------------------------+----------+-------+---------+-----------------------------+-----------------+\n| 69 | completed | Apply role common                                     |       49 |    21 |      68 | 2023-09-30T10:14:01.731212Z | 00:00:38.238032 |\n+----+-----------+-------------------------------------------------------+----------+-------+---------+-----------------------------+-----------------+\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"(ara) play show 69\n+----------+------------------------------------------+\n| Field    | Value                                    |\n+----------+------------------------------------------+\n| id       | 69                                       |\n| report   | http://ara-server:8000/playbooks/49.html |\n| status   | completed                                |\n| name     | Apply role common                        |\n| playbook | (49) /ansible/kolla-common.yml           |\n| started  | 2023-09-30T10:14:01.731212Z              |\n| ended    | 2023-09-30T10:14:39.969244Z              |\n| duration | 00:00:38.238032                          |\n| items    | {'tasks': 21, 'results': 68}             |\n+----------+------------------------------------------+\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"(ara) task list\n+-----+-----------+---------+---------------------------------+----------------------------------------------------------------------------+----------+-----------------------------+-----------------+\n|  id | status    | results | action                          | name                                                                       | playbook | started                     | duration        |\n+-----+-----------+---------+---------------------------------+----------------------------------------------------------------------------+----------+-----------------------------+-----------------+\n| 910 | completed |       0 | meta                            | common : Flush handlers                                                    |       49 | 2023-09-30T10:14:37.126872Z | 00:00:02.552006 |\n| 909 | completed |       4 | file                            | common : Link kolla_logs volume to /var/log/kolla                          |       49 | 2023-09-30T10:14:35.502754Z | 00:00:01.039468 |\n| 908 | completed |       4 | kolla_docker                    | common : Creating log volume                                               |       49 | 2023-09-30T10:14:34.134312Z | 00:00:01.076976 |\n| 907 | completed |       4 | kolla_docker                    | common : Check common containers                                           |       49 | 2023-09-30T10:14:31.411916Z | 00:00:02.146165 |\n| 906 | completed |       4 | template                        | common : Copy rabbitmq erl_inetrc to kolla toolbox                         |       49 | 2023-09-30T10:14:29.500998Z | 00:00:01.327607 |\n| 905 | completed |       4 | template                        | common : Copy rabbitmq-env.conf to kolla toolbox                           |       49 | 2023-09-30T10:14:27.979869Z | 00:00:01.231630 |\n| 904 | completed |       4 | file                            | common : Ensuring config directories have correct owner and permission     |       49 | 2023-09-30T10:14:26.422535Z | 00:00:01.263370 |\n| 903 | completed |       4 | template                        | common : Ensure RabbitMQ Erlang cookie exists                              |       49 | 2023-09-30T10:14:24.880329Z | 00:00:01.255475 |\n| 902 | completed |       4 | template                        | common : Copying over cron logrotate config file                           |       49 | 2023-09-30T10:14:23.199518Z | 00:00:01.392765 |\n| 901 | completed |       4 | template                        | common : Copying over td-agent.conf                                        |       49 | 2023-09-30T10:14:21.085351Z | 00:00:01.826039 |\n| 900 | completed |       1 | find                            | common : Find custom fluentd output config files                           |       49 | 2023-09-30T10:14:19.859670Z | 00:00:00.939663 |\n| 899 | completed |       1 | find                            | common : Find custom fluentd format config files                           |       49 | 2023-09-30T10:14:18.711171Z | 00:00:00.858586 |\n| 898 | completed |       1 | find                            | common : Find custom fluentd filter config files                           |       49 | 2023-09-30T10:14:17.542234Z | 00:00:00.877270 |\n| 897 | completed |       1 | find                            | common : Find custom fluentd input config files                            |       49 | 2023-09-30T10:14:15.911699Z | 00:00:01.315217 |\n| 896 | completed |       4 | template                        | common : Copying over config.json files for services                       |       49 | 2023-09-30T10:14:13.588195Z | 00:00:02.031647 |\n| 895 | completed |       4 | copy                            | service-cert-copy : common | Copying over backend internal TLS key         |       49 | 2023-09-30T10:14:12.216984Z | 00:00:01.074853 |\n| 894 | completed |       4 | copy                            | service-cert-copy : common | Copying over backend internal TLS certificate |       49 | 2023-09-30T10:14:10.895833Z | 00:00:01.022530 |\n| 893 | completed |       4 | copy                            | service-cert-copy : common | Copying over extra CA certificates            |       49 | 2023-09-30T10:14:08.551850Z | 00:00:02.040932 |\n| 892 | completed |       4 | include_tasks                   | common : include_tasks                                                     |       49 | 2023-09-30T10:14:07.019883Z | 00:00:00.950605 |\n| 891 | completed |       4 | file                            | common : Ensuring config directories exist                                 |       49 | 2023-09-30T10:14:04.801633Z | 00:00:01.926842 |\n| 890 | completed |       4 | include_tasks                   | common : include_tasks                                                     |       49 | 2023-09-30T10:14:03.054547Z | 00:00:01.166032 |\n+-----+-----------+---------+---------------------------------+----------------------------------------------------------------------------+----------+-----------------------------+-----------------+\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"(ara) task show 910\n+----------+------------------------------------------+\n| Field    | Value                                    |\n+----------+------------------------------------------+\n| id       | 910                                      |\n| uuid     | 0242ac1f-6510-3867-9eea-00000000004f     |\n| report   | http://ara-server:8000/playbooks/49.html |\n| name     | common : Flush handlers                  |\n| action   | meta                                     |\n| status   | completed                                |\n| path     | /ansible/roles/common/tasks/deploy.yml   |\n| lineno   | 8                                        |\n| started  | 2023-09-30T10:14:37.126872Z              |\n| ended    | 2023-09-30T10:14:39.678878Z              |\n| duration | 00:00:02.552006                          |\n| tags     | ['common']                               |\n| handler  | False                                    |\n+----------+------------------------------------------+\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"(ara) playbook list\n+----+-----------+-------------------------------+--------+-----------------+---------------------------------------------------+-------+---------+-------+-----------------------------+-----------------+\n| id | status    | controller                    | user   | ansible_version | path                                              | tasks | results | hosts | started                     | duration        |\n+----+-----------+-------------------------------+--------+-----------------+---------------------------------------------------+-------+---------+-------+-----------------------------+-----------------+\n| 49 | completed | kolla-ansible.manager_default | dragon | 2.14.10         | /ansible/kolla-common.yml                         |    21 |      68 |     5 | 2023-09-30T10:14:01.410334Z | 00:00:39.135309 |\n+----+-----------+-------------------------------+--------+-----------------+---------------------------------------------------+-------+---------+-------+-----------------------------+-----------------+\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"(ara) playbook metrics\n+---------------------------------------------------+-------+----------------+----------------+-------+---------+-------+-----------+--------+---------+\n| aggregate                                         | count | duration_total | duration_avg   | tasks | results | hosts | completed | failed | running |\n+---------------------------------------------------+-------+----------------+----------------+-------+---------+-------+-----------+--------+---------+\n| /ansible/kolla-common.yml                         |     2 | 0:02:53.934432 | 0:01:26.967216 |    46 |     152 |    10 |         2 |      0 |       0 |\n+---------------------------------------------------+-------+----------------+----------------+-------+---------+-------+-----------+--------+---------+\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"(ara) host list\n+-----+-----------------------------------+----------+---------+--------+----+---------+-------------+-----------------------------+\n|  id | name                              | playbook | changed | failed | ok | skipped | unreachable | updated                     |\n+-----+-----------------------------------+----------+---------+--------+----+---------+-------------+-----------------------------+\n| 164 | testbed-node-2.testbed.osism.xyz  |       49 |       0 |      0 | 14 |       2 |           0 | 2023-09-30T10:14:40.543599Z |\n| 161 | testbed-manager.testbed.osism.xyz |       49 |       0 |      0 | 18 |       2 |           0 | 2023-09-30T10:14:40.283581Z |\n| 163 | testbed-node-1.testbed.osism.xyz  |       49 |       0 |      0 | 14 |       2 |           0 | 2023-09-30T10:14:40.280601Z |\n| 162 | testbed-node-0.testbed.osism.xyz  |       49 |       0 |      0 | 14 |       2 |           0 | 2023-09-30T10:14:40.279181Z |\n| 165 | kolla-ansible.manager_default     |       49 |       0 |      0 |  0 |       0 |           0 | 2023-09-30T10:14:16.932135Z |\n+-----+-----------------------------------+----------+---------+--------+----+---------+-------------+-----------------------------+\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"(ara) host show 164\n+-------------+------------------------------------------+\n| Field       | Value                                    |\n+-------------+------------------------------------------+\n| id          | 164                                      |\n| report      | http://ara-server:8000/playbooks/49.html |\n| name        | testbed-node-2.testbed.osism.xyz         |\n| changed     | 0                                        |\n| failed      | 0                                        |\n| ok          | 14                                       |\n| skipped     | 2                                        |\n| unreachable | 0                                        |\n| updated     | 2023-09-30T10:14:40.543599Z              |\n+-------------+------------------------------------------+\n")),(0,r.kt)("h2",{id:"container"},"Container"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"$ osism log container testbed-node-0 horizon\n[...]\n++++ APACHE_LOCK_DIR=/var/lock/apache2\n++++ export APACHE_LOG_DIR=/var/log/apache2\n++++ APACHE_LOG_DIR=/var/log/apache2\n++++ export LANG=C\n++++ LANG=C\n++++ export LANG\n+++ install -d /var/run/apache2/\n+++ rm -rf '/var/run/apache2/*'\n+++ [[ ubuntu =~ centos|rocky ]]\n+ echo 'Running command: '\\''/usr/sbin/apache2 -DFOREGROUND'\\'''\n+ exec /usr/sbin/apache2 -DFOREGROUND\nAH00558: apache2: Could not reliably determine the server's fully qualified domain name, using 192.168.16.10. Set the 'ServerName' directive globally to suppress this message\n")),(0,r.kt)("h2",{id:"opensearch"},"OpenSearch"),(0,r.kt)("p",null,"OpenSearch can be queried with ",(0,r.kt)("a",{parentName:"p",href:"https://opensearch.org/docs/latest/search-plugins/sql/sql/index/"},"SQL"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"$ osism log opensearch\n")))}d.isMDXComponent=!0}}]);